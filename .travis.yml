dist: trusty
sudo: required
services:
- docker
language: node_js
node_js:
- 9.5.0
branches:
  except:
  - "/\\+travis\\.\\d+$/"
  - "/^\\d+\\.\\d+\\.\\d+-.*\\d+$/"
env:
  global:
  - ATOMIST_TEAM=T29E48P34
  - NPM_PUBLISH=true
  - NPM_REGISTRY=https://atomist.jfrog.io/atomist/api/npm/npm-dev-local
  - secure: IhdbuzDS0zFqnUtm1k6syywINH2kai4L2hZTFxPeGBOlju58I1LBM+FVQkPaG9DRYoC5L6KgYT4vJRn+vDWvHq6t22gSRTJSRUY81mOgV1CCGLhIMF2WqixGGuEE/sbujMG8I0G8GC+7BctTY7NJOMghIYUAq9/uSnbdLFW3/FHdYjvt3cd5/FHXUnOSnp6fSB/LZVl0wI9DTqXSw91eNnFi+nYwC1UZ5Uu07u6eVxUrIM6rp57cztgfA9sV1i79Ourq5z3wJ7dzuRbzPkRFV0PcRk13aGqQuL5vIdYOJ2D07WC2LYwRvepSxruIzSfMTx2kA4O/OKS9NKrT7p5HQ8xQmHXhESlQBMnMbn/MNvrWqq370g7EQtO3uEoZjvE5yldU/zs45gGbHkUXZK2NoUHziXHAjmvUbJjrJQPKCertavdDGQO8lHFZxnxiwi9ExJrPWB1DJL1eSOwEXKYDvnjzW2q80KhEI7gIO+vCsO2g1+LU4X8mn/b/z7RhUhSDsyTOcyNQ02H/IvuVEJMbrnd9G2Y0lWpnSuMYu9ePg9qyWNrVUK98zjvEW13WaUsT2U8VhQlwseDZoQJBdj7DVbKUC4Sjri1TODO2aDIWvYzf/ufibPC/gjDgN+PFjN8B+mA4ClZgwcecV8MkHebEyfT8esf962d7HR71b2ExB+4=
  - DOCKER_REGISTRY=atomist
  - DOCKER_USER=atomist
  - secure: qRPrfXEX7U5m+7nHfQ9isJ3Tl4Se2UIWEtwdfrWL3bvWFUVw6LssRzr2+BCvSUwUSuaYeMTn/2AfuTZLjaBS0039Ps/Mw1Ky49FAM37rx64tBTRcCwXjq7nXh1aLS1kAN0lcWi7fT3MvW302IFUKBqtWwVFK0FFMWESYbQLUUPgEMZ/8JR26wppyZyT6fdpUmKzlauwIyMizcBYDv5BIrcR3vkNHxwfER7EQ4mPgbkyJ3haB94kLbp4Qn1fJye0XUV3ReMF3OJ38I8m4qgN0vRMh/1QbAce+ACBlqSstevvUKY2BhHDvlrZBfbotfXabcauEvYpGAWMeYKuTylEU9pvovA1nNtQWobbgaiIQCHQRmXyj0CegDNT3BJUnrU0fWC65U/oTMGcVHXt4Qsj7xDZ6PmhB0SUocoQgB6+8k79NUN02e/L9HSVd/CQ/88mtrRgxcLDXw7omPXcze2QVr7nLenHvlR8ErIGLGt93TwZWfL0X60lPa24H8UoEpiKkjDdOji8Z+uVT/sGFU5+GJqGCsu01f9ebBppJg4yCO+Zo+Dh15fyWen+BvR9MaEDaOnXUeAgeu+kOTufYSl+KY3j9dBg7CuWxvIuz4V2HMkJlLnTwx2m/OJomHtZ8YVRgieQO5TMeyTVby2bR8AxCdFKhO9OMXLSTb0HJ159l8xI=
before_install:
- openssl aes-256-cbc -K $encrypted_7996a0bf7536_key -iv $encrypted_7996a0bf7536_iv
  -in .npmrc.enc -out .npmrc -d
script: bash scripts/travis-build.bash
notifications:
  email: false
  webhooks:
    urls:
    - https://webhook.atomist.com/atomist/travis/teams/T29E48P34
    on_success: always
    on_failure: always
    on_start: always
    on_cancel: always
    on_error: always
before_deploy:
- touch build/typedoc/.nojekyll
deploy:
- provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  local_dir: build/typedoc
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
- provider: releases
  api_key: "$GITHUB_TOKEN"
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
